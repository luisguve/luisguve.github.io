<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Strapi Plugin Ratings - Luis G. Villegas</title><meta name=description content="Strapi plugin to allow your users to post reviews on any type of content"><meta name=robots content="noodp"><link rel=canonical href=https://luisguve.github.io/plugins/strapi-plugin-ratings/><meta name=twitter:card content="summary"><meta name=twitter:description content="Strapi plugin to allow your users to post reviews on any type of content"><meta name=twitter:title content="Strapi Plugin Ratings - Luis G. Villegas"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:type" content="article"><meta content="Strapi Plugin Ratings - Luis G. Villegas" property="og:title"><meta content="Strapi plugin to allow your users to post reviews on any type of content" property="og:description"><meta property="og:url" content="https://luisguve.github.io/plugins/strapi-plugin-ratings/"><meta property="og:site_name" content="Luis G. Villegas"><meta property="article:section" content="plugin"><meta property="article:published_time" content="2022-07-30 15:30:57 +0600 +0600"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Strapi Plugin Ratings","genre":"plugin","url":"https:\/\/luisguve.github.io\/plugins\/strapi-plugin-ratings\/","datePublished":"2022-07-30 15:30:57 \u002b0600 \u002b0600","description":"Strapi plugin to allow your users to post reviews on any type of content","author":{"@type":"Person","name":""}}</script><link rel=stylesheet href=/sass/main.css><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=/css/custom.css></head><body><header class=site-header><nav class="navbar navbar-default"><div class=container-fluid><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#bs-example-navbar-collapse-1 aria-expanded=false>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=https://luisguve.github.io/>Luis G. Villegas</a></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav navbar-right"><li><a href=https://luisguve.github.io/pages/about/>About</a></li><li><a href=https://luisguve.github.io/pages/contact/>Contact</a></li></ul></div></div></nav></header><div class=container><div class=wrapper><div class=row><div class=col-md-8><article class=post itemscope itemtype=http://schema.org/BlogPosting><header class=post-header><h1 class=post-title itemprop="name headline">Strapi Plugin Ratings</h1><p class=post-meta><time datetime=2022-07-30T15:30:57+06:00 itemprop=datePublished>July 30, 2022</time></p></header><div class=post-content itemprop=articleBody><p><a href=https://npmjs.com/package/strapi-plugin-ratings>Ratings</a> is a Strapi plugin that allows your users to post reviews.</p><p>Enable and manage user reviews for your content very easily!</p><h3 id=requirements>Requirements</h3><p>You should have installed an instance of Strapi v4.x.x</p><h3 id=installation>Installation</h3><p>Run the following command in your project root:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm install strapi-plugin-ratings
</span></span></code></pre></div><p>Then, rebuild the admin dashboard using the following command</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm run build
</span></span></code></pre></div><h3 id=configurarion>Configurarion</h3><p>For your frontend to have access to the API, enable the following permissions for <strong>Ratings</strong> from <strong>Users & Permissions Plugin</strong> on your project settings:</p><p>For public, enable: <strong>count</strong>, <strong>find</strong>, <strong>getPageSize</strong> and <strong>getStats</strong>.</p><p>For authenticated, enable <strong>create</strong>, <strong>find</strong> and <strong>getUserReview</strong>.</p><h3 id=display-user-reviews-on-the-frontend>Display user reviews on the frontend</h3><p>Reviews can be displayed in the frontend in two ways:</p><ol><li>Using the React components library <a href=https://npmjs.com/package/strapi-ratings-client>strapi-ratings-client</a> <strong>(recommended)</strong></li><li>Build your custom frontend using the API endpoints, described as follows:</li></ol><h3 id=api>API</h3><p>There are some Typescript interfaces that will help to get an idea of the data structures.</p><h5 id=reviews>Reviews:</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>IReview</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>number</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createdAt</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>comment</span>: <span style=color:#66d9ef>string</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>author</span>: <span style=color:#66d9ef>IAuthor</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>score</span>: <span style=color:#66d9ef>number</span>,
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h5 id=authors>Authors:</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>IAuthor</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>username</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>email</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>number</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h5 id=content-stats>Content Stats</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>IStats</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>averageScore</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>reviewsCount</span>: <span style=color:#66d9ef>number</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The following endpoints are exposed to fetch and post reviews:</p><h5 id=get-reviews-for-a-content-id>Get reviews for a content ID</h5><p><strong>Method</strong>: GET</p><p><strong>Path</strong>: /api/ratings/reviews/:slug</p><p><strong>Optional query parameters</strong>: start, ignoreCount</p><p><strong>Returns</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>reviewsCount</span>: <span style=color:#66d9ef>number</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>averageScore</span>: <span style=color:#66d9ef>number</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>userReview</span>: <span style=color:#66d9ef>IReview</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>reviews</span>: <span style=color:#66d9ef>IReview</span>[]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The parameter <code>start</code> indicates how many reviews to skip. This is for pagination purposes.</p><p>The parameter <code>ignoreCount</code> indicates whether or not to return the total number of reviews associated with the given slug.</p><hr><h5 id=get-review-stats-for-a-content-id>Get review stats for a content ID</h5><p><strong>Method</strong>: GET</p><p><strong>Path</strong>: /api/ratings/reviews/:slug/stats</p><p><strong>Returns</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>averageScore</span>: <span style=color:#66d9ef>number</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>reviewsCount</span>: <span style=color:#66d9ef>number</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><hr><h5 id=get-the-number-of-reviews-associated-with-a-given-content-id>Get the number of reviews associated with a given content ID</h5><p><strong>Method</strong>: GET</p><p><strong>Path</strong>: /api/ratings/reviews/:slug/count</p><p><strong>Returns</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>count</span>: <span style=color:#66d9ef>number</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><hr><h5 id=post-a-review>Post a review</h5><p><strong>Method</strong>: POST</p><p><strong>Path</strong>: /api/ratings/reviews/:slug</p><p><strong>Authentication</strong>: Bearer token</p><p><strong>Payload</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>content</span>: <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Returns</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>number</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>By default, every authenticated user can post reviews on any content.</p><p>In order to customize this behavior, e.g. allowing or disallowing a user from posting reviews, you must <strong>extend</strong> the service <code>userCanPostReview</code> from whithin <code>register</code> function in ./src/index.js. For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>strapi</span>.<span style=color:#a6e22e>service</span>(<span style=color:#e6db74>&#34;plugin::ratings.review&#34;</span>).<span style=color:#a6e22e>userCanPostReview</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>user</span>, <span style=color:#a6e22e>slug</span>) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>    Here you will check whether or not the user
</span></span></span><span style=display:flex><span><span style=color:#75715e>    is allowed to post a review on this content ID
</span></span></span><span style=display:flex><span><span style=color:#75715e>    and return either true or false.
</span></span></span><span style=display:flex><span><span style=color:#75715e>  */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Notice that <code>userCanPostReview</code> will receive two parameters: the <code>user</code> from <code>Users & Permissions Plugin</code>, containing it&rsquo;s id, username, confirmed, etc., and the <code>slug</code>, which is a string and refers to the content ID which the review is being posted on.</p><p>In case this function returns <code>false</code>, the response of the endpoint will be 403 (forbidden) with the text <code>User cannot post a review on this content</code>.</p><hr><h5 id=get-the-page-size>Get the page size</h5><p><strong>Method</strong>: GET</p><p><strong>Path</strong>: /api/ratings/page-size</p><p><strong>Returns</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pageSize</span>: <span style=color:#66d9ef>number</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><hr><h3 id=general-settings>General settings</h3><p>The plugin allows to set how many reviews are returned per page by going to the <strong>Pagination</strong> section under <strong>Ratings Plugin</strong> of the <strong>Settings</strong> section.</p><p>The default page size is 10.</p><h3 id=management-of-reviews>Management of reviews</h3><p>Admin users are able to delete reviews from within the plugin page of the Strapi admin dashboard.</p><p>The plugin interface has two tabs: one for the latest reviews and one for reviews by content ID.</p><h3 id=roadmap-and-future-plans>Roadmap and future plans</h3><p>The plugin is pretty basic but it can be improved with more features and a better UI/UX. Collaborations and suggestions are very welcome.</p></div></article><div class=row></div><div class=row><ul class=pager><li><a class=previous href=https://luisguve.github.io/tutorials/how-to-enable-and-manage-comments-in-your-strapi-application/>How To Enable And Manage Comments In Your Strapi Application &#187;</a></li></ul></div></div><div class="col-md-4 mt20"><div class=post-img><img width=600 src=https://luisguve.github.io/images/strapilogo.jpg alt=webjeda></div><div class="mt10 recent"><h2>Recent articles</h2><ul><li><p><a href=https://luisguve.github.io/plugins/strapi-plugin-ratings/>Strapi Plugin Ratings</a><small>&nbsp;&nbsp;July 30, 2022</small></p></li><li><p><a href=https://luisguve.github.io/tutorials/how-to-enable-and-manage-comments-in-your-strapi-application/>How To Enable And Manage Comments In Your Strapi Application</a><small>&nbsp;&nbsp;July 29, 2022</small></p></li><li><p><a href=https://luisguve.github.io/plugins/strapi-plugin-comment-manager/>Strapi Plugin Comment Manager</a><small>&nbsp;&nbsp;July 29, 2022</small></p></li></ul></div><br></div></div></div></div><footer><div class=container><div class="row p20"><div class="col-md-4 text-center mt25">All rights reserved by <a target=_blank href=https://github.com/luisguve>Luis Villegas' Portfolio</a></div><div class="col-md-4 text-center mt25"><a target=_blank href=https://bool.netlify.com><img src=https://img.shields.io/badge/Built%20by-bool-brightgreen.svg alt=bool></a></div><div class="col-md-4 text-center mt25"><a target=_blank href=https://github.com/luisguve><li class="social github"><i class="fa fa-github-square"></i></li></a><a target=_blank href=mailto:luisguveal@gmail.com><li class="social email"><i class="fa fa-envelope"></i></li></a></div></div></div></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js></script>
<script src=https://luisguve.github.io//js/bootstrap.min.js></script>
<script async defer src=https://buttons.github.io/buttons.js></script>
<script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","","auto"),ga("send","pageview")</script></body></html>